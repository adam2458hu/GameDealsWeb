<app-back-to-top></app-back-to-top>
<div *ngIf="!getLoadingScreenService().isLoading() && areCurrenciesReceived() && areStoresReceived()" class="container-custom deals">
	<h3 class="text-center">{{ 'totalDeals' | translate }}: {{ getTotalGamesCount() }}</h3>
	<h4 class="text-center">{{ 'searchResults' | translate }}: {{ getFilteredGamesCount() }}</h4>
	<div class="table-responsive">
		<form #filterForm="ngForm" (ngSubmit)="sortTable()">
			<table class="table table-hover">
				<thead>
					<tr><!--
						<th>
							<button type="button" (click)="getFilterService().toggleFilter()">Szűrők</button>
						</th>-->
						<th title="Rendezés név szerint" (click)="sortTable('name')">{{ 'name' | translate }}
							<span>{{ checkSorting('name') }}</span>
						</th>
						<th title="Rendezés akciós ár szerint" (click)="sortTable('specialPrice')" class="text-center">{{ 'discountPrice'| translate }}
							<span>{{ checkSorting('specialPrice') }}</span>
						</th>
						<th title="Rendezés eredeti ár szerint" (click)="sortTable('originalPrice')" class="text-center">
							{{ 'originalPrice' | translate }}
							<span>{{ checkSorting('originalPrice') }}</span>
						</th>
						<th title="Rendezés kedvezmény szerint" (click)="sortTable('discountPercent')" class="text-center">{{ 'discount' | translate }}
							<span>{{ checkSorting('discountPercent') }}</span>
						</th>
						<th title="Rendezés metascore szerint" (click)="sortTable('metascore')" class="text-center">Metascore
							<span>{{ checkSorting('metascore') }}</span>
						</th>
					</tr>
				</thead>
				<tbody><!--
					<tr *ngIf="isFilterOpened()" app-filter
					(filtered)="sortTable($event)"></tr>-->
					<tr *ngFor="let game of getGamesData()" (click)="showAllStores(game)">
						<!--<td id="productImage">
							<img *ngIf="game.stores[0].image;else noimageBlock" src="{{ game.stores[0].image }}" alt="{{ game.name }}">
							<ng-template #noimageBlock>
								<span class="noimage"><fa name="photo"></fa></span>
							</ng-template>
						</td>-->
						<td id="productName">
							<div>{{ game.name }}</div>
							<div id="genres">{{ game.genres }}</div>
						</td>
						<td id="specialPrice" class="text-center">
							{{ currencyConverter(getCheapestStore(game).specialPrice,'EUR',getFilterService().filter.currency).toFixed(getFilterService().filter.decimalPlaces) }} {{ getFilterService().filter.symbol}}
						</td>
						<td id="originalPrice" class="text-center">
							{{ currencyConverter(getCheapestStore(game).originalPrice,'EUR',getFilterService().filter.currency).toFixed(getFilterService().filter.decimalPlaces) }} {{ getFilterService().filter.symbol}}
						</td>
						<td id="discountPercent" class="text-center">
							<span>-{{ getCheapestStore(game).discountPercent }} %</span>
						</td>
						<td id="metascore" class="text-center">
							<span class="metascore rated" *ngIf="game.metascore;else elseBlock">
								{{ game.metascore }}
							</span>
							<ng-template #elseBlock>
								<span class="metascore tba" title="besorolás alatt">TBA</span>
							</ng-template>
						</td>
					</tr>
				</tbody>
			</table>
		</form>
	</div>
	<button type="button" *ngIf="numberOfGamesLeft()>0" class="btn-block" (click)="showMore()">
		{{ 'showNextResults' | translate: {gamesPerRequest:getGamesPerRequest()} }}
	</button>
</div>
<app-game-details [selectedGame]="selectedGame" (close)="onClose()"></app-game-details>